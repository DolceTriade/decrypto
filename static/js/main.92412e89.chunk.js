(window["webpackJsonpmy-app"]=window["webpackJsonpmy-app"]||[]).push([[0],{102:function(e,t,a){e.exports=a(122)},122:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),o=a.n(s),i=a(63),c=a(30),l=a(34),m=a(23),u=a(45),d=a(46),h=a(53),p=a(125),g=a(4),E=a(169),b=a(54),f=a(168),y=a(175),v=a(35),k=a(161),_=a(160),S=a(162),w=a(163),j=a(164),C=a(167),O=a(166),x=a(165),N=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={s:null,connected:!1},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"createSocket",value:function(e){var t=this,a="ws://"+document.domain+":"+window.location.port+"/lobby_ws";var n=new WebSocket(a);return n.onmessage=function(t){console.log("Got server response:"),console.log(t);var a=null;try{a=JSON.parse(t.data)}catch(r){return void console.log(r)}if("command"in a)switch(a.command){case"join_game":var n=new URL(a.game);e.history.push({pathname:n.pathname});break;case"error":console.log("ERROR: "+a.msg),this.props.enqueueSnackbar(a.msg,{variant:"error"});break;default:console.log("Unhandled command: "+a)}else console.log("No command in response from server. "+t)},n.onopen=function(e){return t.setState({connected:!0})},n.onclose=function(e){return t.setState({connected:!1})},n}},{key:"join_or_create",value:function(){var e=document.getElementById("name").value,t=document.getElementById("room").value;e?t?this.state.s.send(JSON.stringify({command:"join_or_create_game",name:e,room:t})):console.log("ERROR: Room cannot be empty."):console.log("ERROR: Name cannot be empty.")}},{key:"componentDidMount",value:function(){console.log("LOBBY MOUNT"),console.log(this.state),null===this.state.s&&this.setState({s:this.createSocket(this.props)})}},{key:"componentWillUnmount",value:function(){console.log("LOBBY UNMOUNT"),null===this.state.s&&(this.state.s.close(),this.setState({s:null}))}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,null),r.a.createElement(k.a,{position:"relative"},r.a.createElement(S.a,null,r.a.createElement(p.a,{variant:"h6",color:"inherit",noWrap:!0},"Decrypto"))),r.a.createElement(w.a,{open:!this.state.connected},r.a.createElement(j.a,null,r.a.createElement(x.a,{container:!0,justify:"center"},r.a.createElement(O.a,{justify:"center",disableShrink:!0})),r.a.createElement(p.a,{component:"h2",align:"center"},"Waiting for WebSocket connection...")),r.a.createElement(C.a,null,r.a.createElement(f.a,{onClick:function(e){return window.location.reload(!1)},color:"primary"},"Refresh"))),r.a.createElement("div",{className:e.heroContent},r.a.createElement(E.a,{maxWidth:"sm"},r.a.createElement(p.a,{component:"h1",variant:"h2",align:"center",color:"textPrimary",gutterBottom:!0},"Decrypto"),r.a.createElement(p.a,{variant:"h5",align:"center",color:"textSecondary",paragraph:!0},"Enter a game name and user name to join or create a game!")),r.a.createElement(E.a,null,r.a.createElement(b.a,{align:"center"},r.a.createElement(y.a,{id:"name",label:"Name",className:e.textField,margin:"normal"}),r.a.createElement(y.a,{id:"room",label:"Room",className:e.textField,margin:"normal"}),r.a.createElement("br",null),r.a.createElement(f.a,{variant:"contained",color:"primary",className:e.heroButtons,onClick:this.join_or_create.bind(this)},"Join or Create Game")))))}}]),t}(r.a.Component),B=Object(v.withSnackbar)(Object(c.e)(Object(g.a)((function(e){return{icon:{marginRight:e.spacing(2)},heroContent:{backgroundColor:e.palette.background.paper,padding:e.spacing(8,0,6)},paper:{display:"flex",flexDirection:"column",marginBottom:e.spacing(1)},heroButtons:{marginTop:e.spacing(4),marginBottom:e.spacing(4)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}}))(N))),R=a(7),T=a(43),G=a(172),P=a(171),D=a(173),W=a(81),M=a.n(W),F=a(80),I=a.n(F),H=a(177),U=a(170),J=a(178),L=a(79),A=a.n(L),Y=a(176),q=a(174);function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function K(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(a,!0).forEach((function(t){Object(R.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Q=function(e){return{icon:{marginRight:e.spacing(2)},heroContent:{height:"available",width:"available",backgroundColor:e.palette.background.paper,padding:e.spacing(8,0,6)},paper:{display:"flex",flexDirection:"column",marginBottom:e.spacing(1)},heroButtons:{marginTop:e.spacing(4),marginBottom:e.spacing(4)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},padding:{padding:e.spacing(0,2),marginBottom:e.spacing(1),fontSize:12},teamName:{paddingBottom:e.spacing(1)},words:{padding:"0.25em"},clueField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},card:{padding:e.spacing(1)},bottomBar:{overflow:"none",left:0,bottom:0,height:e.spacing(10)},chatBox:{width:"100%",overflow:"auto",left:0,bottom:0,height:e.spacing(10)}}},V=function(e){return Math.random().toString(36)};function X(e){return r.a.createElement(x.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(f.a,{variant:"contained",color:"primary",onClick:e.team_a},"Team A")),r.a.createElement(x.a,{item:!0},r.a.createElement(f.a,{variant:"contained",color:"primary",onClick:e.team_b},"Team B")))}function Z(e){return r.a.createElement(x.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(f.a,{variant:"contained",color:"primary",onClick:e.onClick},"Leave Team")))}function $(e){return r.a.createElement(x.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(x.a,{item:!0},r.a.createElement(f.a,{variant:"contained",color:"primary",onClick:e.onClick},"Start")))}function ee(e){var t=[];return e.order.forEach((function(e){t.push(r.a.createElement(x.a,{item:!0,key:e},r.a.createElement(b.a,{p:3},r.a.createElement(p.a,{variant:"h5",align:"center"},e))))})),r.a.createElement(x.a,{container:!0,spacing:1,justify:"center"},t)}function te(e){var t=Object(T.a)(Q),a=null,n=[],s=[];if(e.round.clue_giver!==e.me||"guesses"in e.round)if("clues"in e.round&&!("guesses"in e.round)){for(c=0;c<3;++c){var o="guesses"+c;n.push(r.a.createElement(x.a,{item:!0,key:o},r.a.createElement(y.a,{id:o,name:c.toString(),autoComplete:"off",type:"number",label:e.round.clues[c],className:t.clueField,margin:"normal",onChange:e.setGuesses})))}s.push(r.a.createElement(f.a,{key:"submitg",variant:"contained",color:"primary",onClick:e.submitGuesses},"Submit Guesses"))}else if("spy_clues"in e.round&&!("team_spy_guesses"in e.round)&&"clues"in e.round){for(c=0;c<3;++c){var i="spyguesses"+c;n.push(r.a.createElement(x.a,{item:!0,key:i},r.a.createElement(y.a,{id:i,name:c.toString(),autoComplete:"off",type:"number",label:e.round.spy_clues[c],className:t.clueField,margin:"normal",onChange:e.setSpyGuesses})))}s.push(r.a.createElement(f.a,{key:"submitsg",variant:"contained",color:"primary",onClick:e.submitSpyGuesses},"Submit Spy Guesses"))}else"spy_order"in e.round&&"order"in e.round?(a=r.a.createElement(E.a,null,r.a.createElement(p.a,null,"Your order:"),r.a.createElement(ee,{order:e.round.order}),r.a.createElement(p.a,null,"Your Guess:"),r.a.createElement(ee,{order:e.round.guesses}),r.a.createElement(p.a,null,"Spies Order:"),r.a.createElement(ee,{order:e.round.spy_order}),r.a.createElement(p.a,null,"Your Spy Guess:"),r.a.createElement(ee,{order:e.round.team_spy_guesses})),n.push(r.a.createElement(x.a,{item:!0,key:V()},r.a.createElement(p.a,null,"Your Clues:"))),e.round.clues.forEach((function(e,t){n.push(r.a.createElement(x.a,{item:!0,key:V()},r.a.createElement(p.a,null,t+1,". ",e)))})),n.push(r.a.createElement(x.a,{item:!0,key:V()},r.a.createElement(p.a,null,"Spy Clues:"))),e.round.spy_clues.forEach((function(e,t){n.push(r.a.createElement(x.a,{item:!0,key:V()},r.a.createElement(p.a,null,t+1,". ",e)))})),n=r.a.createElement(x.a,{container:!0,direction:"column",justify:"center"},n)):n=r.a.createElement(x.a,{container:!0,justify:"center"},r.a.createElement(O.a,{justify:"center",disableShrink:!0}));else{if("clues"in e.round)n=r.a.createElement(x.a,{container:!0,justify:"center"},r.a.createElement(O.a,{justify:"center",disableShrink:!0}));else for(var c=0;c<3;++c){var l="clues"+c;n.push(r.a.createElement(x.a,{item:!0,key:l},r.a.createElement(y.a,{id:l,name:c.toString(),autoComplete:"off",label:"Clue #"+(c+1),className:t.clueField,margin:"normal",onChange:e.setClues})))}"order"in e.round&&(a=r.a.createElement(ee,{order:e.round.order})),"clues"in e.round||s.push(r.a.createElement(f.a,{key:"submitc",variant:"contained",color:"primary",onClick:e.submitClues},"Submit Clues"))}return r.a.createElement(H.a,{expanded:e.expanded===e.round.number,onChange:e.handleExpansion(e.round.number)},r.a.createElement(J.a,{expandIcon:r.a.createElement(A.a,null)},r.a.createElement(p.a,{color:"textPrimary",variant:"h3"},"Round ",e.round.number+1)),r.a.createElement(U.a,null,r.a.createElement(x.a,{className:t.card,spacing:2,container:!0},a,n),s))}function ae(e){var t=[];e.chat.forEach((function(e,a){t.push(r.a.createElement(E.a,{key:e.date+e.date.getMilliseconds()+e.name+e.chat},r.a.createElement(p.a,{display:"inline"},"[",e.date.getHours(),":",e.date.getMinutes(),"]"),r.a.createElement(p.a,{display:"inline"}," ",r.a.createElement("b",null,e.name)),r.a.createElement(p.a,{display:"inline"},": ",e.message)))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{id:e.id,className:e.className},t),r.a.createElement(y.a,{name:"chat",fullWidth:!0,onKeyUp:function(t){t.preventDefault(),"Enter"===t.key&&(e.sendchat(t.target.value),t.target.value=null)},autoComplete:"off",label:"Press enter to send chat...",margin:"normal"}))}function ne(e){return r.a.createElement(E.a,{hidden:e.value!==e.index},e.children)}var re=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={team_a:new Set,team_b:new Set,players:new Set,me:"",host:"",state:"setup",s:null,connected:!1,message:"Select a team to join!",words:[],rounds:[],drawer:!1,clues:[],guesses:[],spy_guesses:[],score:null,expanded:!1,tab:0,all_chat:[],team_chat:[]},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"onMessage",value:function(e){if(console.log("Got server response:"),console.log(e.data),e.data){var t=null;try{t=JSON.parse(e.data)}catch(u){return void console.log(u)}if("command"in t)switch(t.command){case"error":console.log("ERROR: "+t.msg),this.error(t.msg);break;case"player_connected":var a=new Set(this.state.players);a.add(t.player),this.setState({players:a}),1===this.state.players.size&&this.setState({me:t.player});break;case"player_disconnected":var n=new Set(this.state.players);n.delete(t.player),this.setState({players:n});break;case"joined_team":if(this.state.me===t.name&&this.setState({message:"Waiting for game to start..."}),"a"===t.team){var r=new Set(this.state.team_a);r.add(t.name),this.setState({team_a:r})}else{if("b"!==t.team)return void console.log("ERROR: joined_team: invalid team: "+t.team);var s=new Set(this.state.team_b);s.add(t.name),this.setState({team_b:s})}break;case"left_team":if("a"===t.team){var o=new Set(this.state.team_a);o.delete(t.name),this.setState({team_a:o})}else{if("b"!==t.team)return void console.log("ERROR: left_team: invalid team: "+t.team);var i=new Set(this.state.team_b);i.delete(t.name),this.setState({team_b:i})}break;case"new_host":this.setState({host:t.player});break;case"words":this.setState({state:"words"}),this.setState({words:t.words.slice(0)});break;case"round":var c=this.state.rounds.slice(0);c[t.number]=K({},c[t.number],{},t),"clues"in c[t.number]&&"guesses"in c[t.number]?this.setState({rounds:c,message:"Guess the enemies order...",spy_guesses:[],expanded:t.number}):"clues"in c[t.number]?this.setState({rounds:c,message:"Match the clues with the word...",guesses:[],expanded:t.number}):this.setState({rounds:c,message:"Waiting for clues...",clues:[],expanded:t.number});break;case"order":var l=this.state.rounds.slice(0);if(l[t.number]||(l[t.number]={}),"order"in l[t.number])break;l[t.number].order=t.order,this.setState({rounds:l,message:"Please give clues that match the order"});break;case"score":"winner"in t?this.setState({score:t,message:t.winner+" wins the game! The words are: Team A: "+t.words.team_a+" Team B:"+t.words.team_b}):"tie"in t?this.setState({score:t,message:"Game is a tie! The words are: Team A: "+t.words.team_a+" Team B:"+t.words.team_b}):this.setState({score:t});break;case"team_chat":var m=this.state.team_chat;m.push(K({date:new Date},t)),this.setState({team_chat:m});var u=document.getElementById("team_chat");u.scrollTop>=u.scrollHeight-u.clientHeight-u.lastChild.clientHeight&&(u.scrollTop=u.scrollHeight);break;case"all_chat":var d=this.state.all_chat;d.push(K({date:new Date},t)),this.setState({all_chat:d});var h=document.getElementById("all_chat");h.scrollTop>=h.scrollHeight-h.clientHeight-h.lastChild.clientHeight&&(h.scrollTop=h.scrollHeight);break;default:console.log("Unhandled: "+t)}else console.log("No command in response from server. "+e)}}},{key:"createSocket",value:function(e){var t=this,a="ws://"+document.domain+":"+window.location.port+window.location.pathname+"/ws";var n=new WebSocket(a);return n.onerror=function(e){console.log("ERROR:"),console.log(e)},n.onmessage=function(e){return t.onMessage(e)},n.onopen=function(e){return t.setState({connected:!0})},n.onclose=function(e){return t.setState({connected:!1})},n}},{key:"componentDidMount",value:function(){null===this.state.s&&this.setState({s:this.createSocket(this.props)})}},{key:"componentWillUnmount",value:function(){null===this.state.s&&(this.state.s.close(),this.setState({s:null}))}},{key:"send",value:function(e){this.state.s&&this.state.s.readyState===this.state.s.OPEN?this.state.s.send(JSON.stringify(e)):this.error("Websocket not connected! Try refreshing.")}},{key:"error",value:function(e){var t=this;this.props.enqueueSnackbar(e,{variant:"error",action:function(e){return r.a.createElement(f.a,{onClick:function(){t.props.closeSnackbar(e)}},"Dismiss ",r.a.createElement(I.a,null))}})}},{key:"join_a",value:function(){this.send({command:"join_a"})}},{key:"join_b",value:function(){this.send({command:"join_b"})}},{key:"leave_team",value:function(){this.send({command:"leave_team"})}},{key:"start_game",value:function(){this.send({command:"start_game"})}},{key:"set_field",value:function(e,t){var a=this.state[e],n={};"number"===t.target.type?a[parseInt(t.target.name)]=parseInt(t.target.value):a[parseInt(t.target.name)]=t.target.value,n[e]=a,this.setState(n)}},{key:"submit_field",value:function(e,t){var a,n=this.state[e];if(3===n.length)if(n.reduce((function(e,t){return e&&t}),!0)){var r={};r[e]=[],this.setState(r),this.send((a={command:e},Object(R.a)(a,e,n),Object(R.a)(a,"number",this.state.rounds.length-1),a))}else this.error("Some "+e+" empty!");else this.error("Only "+n.length+" set!")}},{key:"send_chat",value:function(e,t){this.send({command:e,message:t})}},{key:"getClueGiver",value:function(){return"words"!==this.state.state?null:0===this.state.rounds.length?null:this.state.rounds[this.state.rounds.length-1].clue_giver}},{key:"getSpyClueGiver",value:function(){return"words"!==this.state.state?null:0===this.state.rounds.length?null:this.state.rounds[this.state.rounds.length-1].spy_clue_giver}},{key:"toggleDrawer",value:function(){this.setState({drawer:!this.state.drawer})}},{key:"handleExpansion",value:function(e){var t=this;return function(a,n){t.setState({expanded:!!n&&e})}}},{key:"handleTabChange",value:function(e,t){this.setState({tab:t})}},{key:"render",value:function(){var e=this.props.classes,t=[],a=[],n=this.state.host,s=this.state.me,o=this.getClueGiver(),i=this.getSpyClueGiver();[[this.state.team_a,t],[this.state.team_b,a]].forEach((function(t){t[0].forEach((function(a){var n=a===o||a===i?"CG":0,c=s===a?"textPrimary":"textSecondary";t[1].push(r.a.createElement(x.a,{xs:!0,item:!0,key:a},r.a.createElement(P.a,{badgeContent:n,color:"secondary",className:e.padding},r.a.createElement(p.a,{component:"h5",align:"center",color:c,key:a},a)),r.a.createElement(G.a,null)))}))}));var c=[],l=[];"setup"===this.state.state?this.state.team_a.has(this.state.me)||this.state.team_b.has(this.state.me)?(c.push(r.a.createElement(Z,{key:"leave",onClick:this.leave_team.bind(this)})),this.state.me===n&&c.push(r.a.createElement($,{key:"start",onClick:this.start_game.bind(this)}))):c=r.a.createElement(X,{key:"join",team_a:this.join_a.bind(this),team_b:this.join_b.bind(this)}):this.state.words.length>0&&this.state.words.forEach((function(t,a){l.push(r.a.createElement(x.a,{item:!0,key:t},r.a.createElement(P.a,{badgeContent:a+1,color:"secondary"},r.a.createElement(b.a,{className:e.card},r.a.createElement(p.a,{component:"h1",variant:"h3",align:"center",color:"textPrimary",gutterBottom:!0},t)))))}));var m=[],u=this;this.state.rounds.forEach((function(e){m.push(r.a.createElement(x.a,{item:!0,key:e.number},r.a.createElement(te,{round:e,me:s,expanded:u.state.expanded,handleExpansion:u.handleExpansion.bind(u),setClues:u.set_field.bind(u,"clues"),submitClues:u.submit_field.bind(u,"clues"),setGuesses:u.set_field.bind(u,"guesses"),submitGuesses:u.submit_field.bind(u,"guesses"),setSpyGuesses:u.set_field.bind(u,"spy_guesses"),submitSpyGuesses:u.submit_field.bind(u,"spy_guesses")})))}));var d=[];return this.state.score&&(d=r.a.createElement(E.a,null,r.a.createElement(x.a,{container:!0,justify:"center",spacing:1},r.a.createElement(x.a,{item:!0},r.a.createElement(b.a,{className:e.padding},r.a.createElement(p.a,{variant:"h6"},"Team A"),r.a.createElement(p.a,null,"Intercepts: ",this.state.score.team_a.intercepts),r.a.createElement(p.a,null,"Miscommunications: ",this.state.score.team_a.miscommunications))),r.a.createElement(x.a,{item:!0},r.a.createElement(b.a,{className:e.padding},r.a.createElement(p.a,{variant:"h6"},"Team B"),r.a.createElement(p.a,null,"Intercepts: ",this.state.score.team_b.intercepts),r.a.createElement(p.a,null,"Miscommunications: ",this.state.score.team_b.miscommunications)))))),r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,null),r.a.createElement(k.a,{position:"relative"},r.a.createElement(S.a,null,r.a.createElement(M.a,{className:e.icon,onClick:this.toggleDrawer.bind(this)}),r.a.createElement(p.a,{variant:"h6",color:"inherit",noWrap:!0},"Decrypto"))),r.a.createElement(D.a,{open:this.state.drawer,onClose:this.toggleDrawer.bind(this)},r.a.createElement(E.a,null,r.a.createElement(b.a,null,r.a.createElement(p.a,{component:"h3",variant:"h5",align:"center",color:"textPrimary",className:e.teamName},"Team A"),t),r.a.createElement(b.a,null,r.a.createElement(p.a,{component:"h3",variant:"h5",align:"center",color:"textPrimary",className:e.teamName},"Team B"),a))),r.a.createElement(w.a,{open:!this.state.connected},r.a.createElement(j.a,null,r.a.createElement(x.a,{container:!0,justify:"center"},r.a.createElement(O.a,{justify:"center",disableShrink:!0})),r.a.createElement(p.a,{component:"h2",align:"center"},"Waiting for WebSocket connection...")),r.a.createElement(C.a,null,r.a.createElement(f.a,{onClick:function(e){return window.location.reload(!1)},color:"primary"},"Refresh"))),r.a.createElement(E.a,{className:e.heroContent},r.a.createElement(E.a,null,d),r.a.createElement(E.a,{maxWidth:"sm"},r.a.createElement(p.a,{component:"h1",variant:"h4",align:"center",color:"textPrimary",gutterBottom:!0},this.state.message)),r.a.createElement(E.a,{className:e.heroButtons},c),r.a.createElement(E.a,{className:e.icon},r.a.createElement(x.a,{container:!0,spacing:2,justify:"center"},l))),r.a.createElement(E.a,null,m),r.a.createElement(E.a,{className:e.bottomBar},r.a.createElement(k.a,{position:"static"},r.a.createElement(Y.a,{value:this.state.tab,onChange:this.handleTabChange.bind(this)},r.a.createElement(q.a,{label:"All Chat",index:0}),r.a.createElement(q.a,{label:"Team Chat",index:1}))),r.a.createElement(ne,{value:this.state.tab,index:0},r.a.createElement(ae,{id:"all_chat",className:e.chatBox,sendchat:this.send_chat.bind(this,"all_chat"),chat:this.state.all_chat})),r.a.createElement(ne,{value:this.state.tab,index:1},r.a.createElement(ae,{id:"team_chat",className:e.chatBox,sendchat:this.send_chat.bind(this,"team_chat"),chat:this.state.team_chat}))))}}]),t}(r.a.Component),se=Object(v.withSnackbar)(Object(g.a)(Q)(re));o.a.render(r.a.createElement((function(){return r.a.createElement(v.SnackbarProvider,{maxSnack:3},r.a.createElement("main",null,r.a.createElement(i.a,null,r.a.createElement(c.a,{exact:!0,path:"/",component:B}),r.a.createElement(c.a,{path:"/game",component:se}))))}),null),document.getElementById("root"))}},[[102,1,2]]]);
//# sourceMappingURL=main.92412e89.chunk.js.map