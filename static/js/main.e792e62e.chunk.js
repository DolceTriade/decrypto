(window["webpackJsonpmy-app"]=window["webpackJsonpmy-app"]||[]).push([[0],{118:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),o=a.n(s),i=a(35),c=a(43),l=(a(170),a(61)),m=a(29),u=a(32),d=a(22),h=a(45),p=a(46),g=a(52),E=a(4),f=a(162),b=a(41),y=a(172),v=a(171),k=a(33),S=a(155),_=a(154),w=a(156),j=a(157),O=a(158),C=a(161),N=a(160),R=a(159),G=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={s:null,connected:!1},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"createSocket",value:function(e){var t=this;console.log("CREATING SOCKET");var a=new WebSocket("ws://"+document.domain+":"+window.location.port+"/lobby_ws");return a.onmessage=function(t){console.log("Got server response:"),console.log(t);var a=null;try{a=JSON.parse(t.data)}catch(r){return void console.log(r)}if("command"in a)switch(a.command){case"join_game":var n=new URL(a.game);e.history.push({pathname:n.pathname});break;case"error":console.log("ERROR: "+a.msg),this.props.enqueueSnackbar(a.msg,{variant:"error"});break;default:console.log("Unhandled command: "+a)}else console.log("No command in response from server. "+t)},a.onopen=function(e){return t.setState({connected:!0})},a.onclose=function(e){return t.setState({connected:!1})},a}},{key:"join_or_create",value:function(){var e=document.getElementById("name").value,t=document.getElementById("room").value;e?t?this.state.s.send(JSON.stringify({command:"join_or_create_game",name:e,room:t})):console.log("ERROR: Room cannot be empty."):console.log("ERROR: Name cannot be empty.")}},{key:"componentDidMount",value:function(){console.log("LOBBY MOUNT"),console.log(this.state),null===this.state.s&&this.setState({s:this.createSocket(this.props)})}},{key:"componentWillUnmount",value:function(){console.log("LOBBY UNMOUNT"),null===this.state.s&&(this.state.s.close(),this.setState({s:null}))}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,null),r.a.createElement(S.a,{position:"relative"},r.a.createElement(w.a,null,r.a.createElement(i.a,{variant:"h6",color:"inherit",noWrap:!0},"Decrypto"))),r.a.createElement(j.a,{open:!this.state.connected},r.a.createElement(O.a,null,r.a.createElement(R.a,{container:!0,justify:"center"},r.a.createElement(N.a,{justify:"center",disableShrink:!0})),r.a.createElement(i.a,{component:"h2",align:"center"},"Waiting for WebSocket connection...")),r.a.createElement(C.a,null,r.a.createElement(y.a,{onClick:function(e){return window.location.reload(!1)},color:"primary"},"Refresh"))),r.a.createElement("div",{className:e.heroContent},r.a.createElement(f.a,{maxWidth:"sm"},r.a.createElement(i.a,{component:"h1",variant:"h2",align:"center",color:"textPrimary",gutterBottom:!0},"Decrypto"),r.a.createElement(i.a,{variant:"h5",align:"center",color:"textSecondary",paragraph:!0},"Enter a game name and user name to join or create a game!")),r.a.createElement(f.a,null,r.a.createElement(b.a,{align:"center"},r.a.createElement(v.a,{id:"name",label:"Name",className:e.textField,margin:"normal"}),r.a.createElement(v.a,{id:"room",label:"Room",className:e.textField,margin:"normal"}),r.a.createElement("br",null),r.a.createElement(y.a,{variant:"contained",color:"primary",className:e.heroButtons,onClick:this.join_or_create.bind(this)},"Join or Create Game")))))}}]),t}(r.a.Component),B=Object(k.withSnackbar)(Object(m.e)(Object(E.a)((function(e){return{icon:{marginRight:e.spacing(2)},heroContent:{backgroundColor:e.palette.background.paper,padding:e.spacing(8,0,6)},paper:{display:"flex",flexDirection:"column",marginBottom:e.spacing(1)},heroButtons:{marginTop:e.spacing(4),marginBottom:e.spacing(4)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}}))(G))),T=a(8),x=a(163),D=a(164),P=a(165),W=a(166),M=a(168),F=a(167),I=a(169),A=a(78),U=a.n(A),J=a(77),L=a.n(J);function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var q=function(e){return{icon:{marginRight:e.spacing(2)},heroContent:{height:"available",width:"available",backgroundColor:e.palette.background.paper,padding:e.spacing(8,0,6)},paper:{display:"flex",flexDirection:"column",marginBottom:e.spacing(1)},heroButtons:{marginTop:e.spacing(4),marginBottom:e.spacing(4)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},padding:{padding:e.spacing(0,2),marginBottom:e.spacing(1),fontSize:12},teamName:{paddingBottom:e.spacing(1)},words:{padding:"0.25em"},clueField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},card:{padding:e.spacing(1)}}},z=function(e){return Math.random().toString(36)};function K(e){return r.a.createElement(R.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(R.a,{item:!0},r.a.createElement(y.a,{variant:"contained",color:"primary",onClick:e.team_a},"Team A")),r.a.createElement(R.a,{item:!0},r.a.createElement(y.a,{variant:"contained",color:"primary",onClick:e.team_b},"Team B")))}function H(e){return r.a.createElement(R.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(R.a,{item:!0},r.a.createElement(y.a,{variant:"contained",color:"primary",onClick:e.onClick},"Leave Team")))}function Q(e){return r.a.createElement(R.a,{container:!0,spacing:2,justify:"center"},r.a.createElement(R.a,{item:!0},r.a.createElement(y.a,{variant:"contained",color:"primary",onClick:e.onClick},"Start")))}function V(e){Object(c.a)(q);var t=[];return e.order.forEach((function(e){t.push(r.a.createElement(R.a,{item:!0,key:e},r.a.createElement(b.a,{p:3},r.a.createElement(i.a,{variant:"h5",align:"center"},e))))})),r.a.createElement(R.a,{container:!0,spacing:1,justify:"center"},t)}function X(e){var t=Object(c.a)(q),a=null,n=[],s=[];if(console.log(e),e.round.clue_giver!==e.me||"guesses"in e.round)if("clues"in e.round&&!("guesses"in e.round)){for(m=0;m<3;++m){var o="guesses"+m;n.push(r.a.createElement(R.a,{item:!0,key:o},r.a.createElement(v.a,{id:o,name:m.toString(),autoComplete:"off",type:"number",label:e.round.clues[m],className:t.clueField,margin:"normal",onChange:e.setGuesses})))}s.push(r.a.createElement(y.a,{key:"submitg",variant:"contained",color:"primary",onClick:e.submitGuesses},"Submit Guesses"))}else if("spy_clues"in e.round&&!("team_spy_guesses"in e.round)&&"clues"in e.round){for(m=0;m<3;++m){var l="spyguesses"+m;n.push(r.a.createElement(R.a,{item:!0,key:l},r.a.createElement(v.a,{id:l,name:m.toString(),autoComplete:"off",type:"number",label:e.round.spy_clues[m],className:t.clueField,margin:"normal",onChange:e.setSpyGuesses})))}s.push(r.a.createElement(y.a,{key:"submitsg",variant:"contained",color:"primary",onClick:e.submitSpyGuesses},"Submit Spy Guesses"))}else"spy_order"in e.round&&"order"in e.round?(a=r.a.createElement(f.a,null,r.a.createElement(i.a,null,"Your order:"),r.a.createElement(V,{order:e.round.order}),r.a.createElement(i.a,null,"Your Guess:"),r.a.createElement(V,{order:e.round.guesses}),r.a.createElement(i.a,null,"Spies Order:"),r.a.createElement(V,{order:e.round.spy_order}),r.a.createElement(i.a,null,"Your Spy Guess:"),r.a.createElement(V,{order:e.round.team_spy_guesses})),n.push(r.a.createElement(R.a,{item:!0,key:z()},r.a.createElement(i.a,null,"Your Clues:"))),e.round.clues.forEach((function(e,t){n.push(r.a.createElement(R.a,{item:!0,key:z()},r.a.createElement(i.a,null,t+1,". ",e)))})),n.push(r.a.createElement(R.a,{item:!0,key:z()},r.a.createElement(i.a,null,"Spy Clues:"))),e.round.spy_clues.forEach((function(e,t){n.push(r.a.createElement(R.a,{item:!0,key:z()},r.a.createElement(i.a,null,t+1,". ",e)))})),n=r.a.createElement(R.a,{container:!0,direction:"column",justify:"center"},n)):n=r.a.createElement(R.a,{container:!0,justify:"center"},r.a.createElement(N.a,{justify:"center",disableShrink:!0}));else{if("clues"in e.round)n=r.a.createElement(R.a,{container:!0,justify:"center"},r.a.createElement(N.a,{justify:"center",disableShrink:!0}));else for(var m=0;m<3;++m){var u="clues"+m;n.push(r.a.createElement(R.a,{item:!0,key:u},r.a.createElement(v.a,{id:u,name:m.toString(),autoComplete:"off",label:"Clue #"+(m+1),className:t.clueField,margin:"normal",onChange:e.setClues})))}"order"in e.round&&(a=r.a.createElement(V,{order:e.round.order})),"clues"in e.round||s.push(r.a.createElement(y.a,{key:"submitc",variant:"contained",color:"primary",onClick:e.submitClues},"Submit Clues"))}return r.a.createElement(x.a,null,r.a.createElement(D.a,{title:"Round "+(e.round.number+1)}),r.a.createElement(P.a,null,r.a.createElement(R.a,{className:t.card,spacing:2,container:!0},a,n)),r.a.createElement(W.a,null,s))}var Z=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(p.a)(t).call(this,e))).state={team_a:new Set,team_b:new Set,players:new Set,me:"",host:"",state:"setup",s:null,connected:!1,message:"Select a team to join!",words:[],rounds:[],drawer:!1,clues:[],guesses:[],spy_guesses:[],score:null},a}return Object(g.a)(t,e),Object(d.a)(t,[{key:"onMessage",value:function(e){if(console.log("Got server response:"),console.log(e.data),e.data){var t=null;try{t=JSON.parse(e.data)}catch(m){return void console.log(m)}if("command"in t)switch(t.command){case"error":console.log("ERROR: "+t.msg),this.error(t.msg);break;case"player_connected":var a=new Set(this.state.players);a.add(t.player),this.setState({players:a}),1==this.state.players.size&&this.setState({me:t.player});break;case"player_disconnected":var n=new Set(this.state.players);n.delete(t.player),this.setState({players:n});break;case"joined_team":if(console.log(t),this.state.me===t.name&&this.setState({message:"Waiting for game to start..."}),"a"===t.team){var r=new Set(this.state.team_a);r.add(t.name),this.setState({team_a:r})}else{if("b"!==t.team)return void console.log("ERROR: joined_team: invalid team: "+t.team);var s=new Set(this.state.team_b);s.add(t.name),this.setState({team_b:s})}break;case"left_team":if("a"===t.team){var o=new Set(this.state.team_a);o.delete(t.name),this.setState({team_a:o})}else{if("b"!==t.team)return void console.log("ERROR: left_team: invalid team: "+t.team);var i=new Set(this.state.team_b);i.delete(t.name),this.setState({team_b:i})}break;case"new_host":this.setState({host:t.player});break;case"words":this.setState({state:"words"}),this.setState({words:t.words.slice(0)});break;case"round":var c=this.state.rounds.slice(0);c[t.number]=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(a,!0).forEach((function(t){Object(T.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},c[t.number],{},t),"clues"in c[t.number]&&"guesses"in c[t.number]?this.setState({rounds:c,message:"Guess the enemies order...",spy_guesses:[]}):"clues"in c[t.number]?this.setState({rounds:c,message:"Match the clues with the word...",guesses:[]}):this.setState({rounds:c,message:"Waiting for clues...",clues:[]});break;case"order":console.log(this.state.rounds),console.log(t);var l=this.state.rounds.slice(0);if(l[t.number]||(l[t.number]={}),"order"in l[t.number])break;l[t.number].order=t.order,this.setState({rounds:l,message:"Please give clues that match the order"});break;case"score":"winner"in t?this.setState({score:t,message:t.winner+" wins the game! The words are: Team A: "+t.words.team_a+" Team B:"+t.words.team_b}):"tie"in t?this.setState({score:t,message:"Game is a tie! The words are: Team A: "+t.words.team_a+" Team B:"+t.words.team_b}):this.setState({score:t});break;default:console.log("Unhandled: "+t)}else console.log("No command in response from server. "+e)}}},{key:"createSocket",value:function(e){var t=this;console.log("CREATING SOCKET");var a=new WebSocket("ws://"+document.domain+":"+window.location.port+window.location.pathname+"/ws");return a.onerror=function(e){console.log("ERROR:"),console.log(e)},a.onmessage=function(e){return t.onMessage(e)},a.onopen=function(e){return t.setState({connected:!0})},a.onclose=function(e){return t.setState({connected:!1})},a}},{key:"componentDidMount",value:function(){console.log("GAME MOUNT"),console.log(this.state),null===this.state.s&&this.setState({s:this.createSocket(this.props)})}},{key:"componentWillUnmount",value:function(){null===this.state.s&&(this.state.s.close(),this.setState({s:null}))}},{key:"send",value:function(e){this.state.s&&this.state.s.readyState===this.state.s.OPEN?this.state.s.send(JSON.stringify(e)):this.error("Websocket not connected! Try refreshing.")}},{key:"error",value:function(e){var t=this;this.props.enqueueSnackbar(e,{variant:"error",action:function(e){return r.a.createElement(y.a,{onClick:function(){t.props.closeSnackbar(e)}},"Dismiss ",r.a.createElement(L.a,null))}})}},{key:"join_a",value:function(){this.send({command:"join_a"})}},{key:"join_b",value:function(){this.send({command:"join_b"})}},{key:"leave_team",value:function(){this.send({command:"leave_team"})}},{key:"start_game",value:function(){this.send({command:"start_game"})}},{key:"set_field",value:function(e,t){var a=this.state[e],n={};"number"==t.target.type?a[parseInt(t.target.name)]=parseInt(t.target.value):a[parseInt(t.target.name)]=t.target.value,n[e]=a,this.setState(n)}},{key:"submit_field",value:function(e,t){var a,n=this.state[e];if(3==n.length)if(n.reduce((function(e,t){return e&&t}),!0)){var r={};r[e]=[],this.setState(r),this.send((a={command:e},Object(T.a)(a,e,n),Object(T.a)(a,"number",this.state.rounds.length-1),a))}else this.error("Some "+e+" empty!");else this.error("Only "+n.length+" set!")}},{key:"getClueGiver",value:function(){return"words"!==this.state.state?null:0==this.state.rounds.length?null:this.state.rounds[this.state.rounds.length-1].clue_giver}},{key:"getSpyClueGiver",value:function(){return"words"!==this.state.state?null:0==this.state.rounds.length?null:this.state.rounds[this.state.rounds.length-1].spy_clue_giver}},{key:"toggleDrawer",value:function(){this.setState({drawer:!this.state.drawer})}},{key:"render",value:function(){console.log("RENDER GAME"),console.log(this.state);var e=this.props.classes,t=[],a=[],n=this.state.host,s=this.state.me,o=this.getClueGiver(),c=this.getSpyClueGiver();[[this.state.team_a,t],[this.state.team_b,a]].forEach((function(t){t[0].forEach((function(a){var n=a==o||a==c?"CG":0,l=s===a?"textPrimary":"textSecondary";t[1].push(r.a.createElement(R.a,{xs:!0,item:!0,key:a},r.a.createElement(F.a,{badgeContent:n,color:"secondary",className:e.padding},r.a.createElement(i.a,{component:"h5",align:"center",color:l,key:a},a)),r.a.createElement(M.a,null)))}))}));var l=[],m=[];"setup"===this.state.state?this.state.team_a.has(this.state.me)||this.state.team_b.has(this.state.me)?(l.push(r.a.createElement(H,{key:"leave",onClick:this.leave_team.bind(this)})),this.state.me===n&&l.push(r.a.createElement(Q,{key:"start",onClick:this.start_game.bind(this)}))):l=r.a.createElement(K,{key:"join",team_a:this.join_a.bind(this),team_b:this.join_b.bind(this)}):this.state.words.length>0&&this.state.words.forEach((function(t,a){m.push(r.a.createElement(R.a,{item:!0,key:t},r.a.createElement(F.a,{badgeContent:a+1,color:"secondary"},r.a.createElement(b.a,{className:e.card},r.a.createElement(i.a,{component:"h1",variant:"h3",align:"center",color:"textPrimary",gutterBottom:!0},t)))))}));var u=[],d=this;this.state.rounds.forEach((function(e){u.push(r.a.createElement(R.a,{item:!0,key:e.number},r.a.createElement(X,{round:e,me:s,setClues:d.set_field.bind(d,"clues"),submitClues:d.submit_field.bind(d,"clues"),setGuesses:d.set_field.bind(d,"guesses"),submitGuesses:d.submit_field.bind(d,"guesses"),setSpyGuesses:d.set_field.bind(d,"spy_guesses"),submitSpyGuesses:d.submit_field.bind(d,"spy_guesses")})))}));var h=[];return this.state.score&&(h=r.a.createElement(f.a,null,r.a.createElement(R.a,{container:!0,justify:"center",spacing:1},r.a.createElement(R.a,{item:!0},r.a.createElement(b.a,{className:e.padding},r.a.createElement(i.a,{variant:"h6"},"Team A"),r.a.createElement(i.a,null,"Intercepts: ",this.state.score.team_a.intercepts),r.a.createElement(i.a,null,"Miscommunications: ",this.state.score.team_a.miscommunications))),r.a.createElement(R.a,{item:!0},r.a.createElement(b.a,{className:e.padding},r.a.createElement(i.a,{variant:"h6"},"Team B"),r.a.createElement(i.a,null,"Intercepts: ",this.state.score.team_b.intercepts),r.a.createElement(i.a,null,"Miscommunications: ",this.state.score.team_b.miscommunications)))))),r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,null),r.a.createElement(S.a,{position:"relative"},r.a.createElement(w.a,null,r.a.createElement(U.a,{className:e.icon,onClick:this.toggleDrawer.bind(this)}),r.a.createElement(i.a,{variant:"h6",color:"inherit",noWrap:!0},"Decrypto"))),r.a.createElement(I.a,{open:this.state.drawer,onClose:this.toggleDrawer.bind(this)},r.a.createElement(f.a,null,r.a.createElement(b.a,null,r.a.createElement(i.a,{component:"h3",variant:"h5",align:"center",color:"textPrimary",className:e.teamName},"Team A"),t),r.a.createElement(b.a,null,r.a.createElement(i.a,{component:"h3",variant:"h5",align:"center",color:"textPrimary",className:e.teamName},"Team B"),a))),r.a.createElement(j.a,{open:!this.state.connected},r.a.createElement(O.a,null,r.a.createElement(R.a,{container:!0,justify:"center"},r.a.createElement(N.a,{justify:"center",disableShrink:!0})),r.a.createElement(i.a,{component:"h2",align:"center"},"Waiting for WebSocket connection...")),r.a.createElement(C.a,null,r.a.createElement(y.a,{onClick:function(e){return window.location.reload(!1)},color:"primary"},"Refresh"))),r.a.createElement(f.a,{className:e.heroContent},r.a.createElement(f.a,null,h),r.a.createElement(f.a,{maxWidth:"sm"},r.a.createElement(i.a,{component:"h1",variant:"h4",align:"center",color:"textPrimary",gutterBottom:!0},this.state.message)),r.a.createElement(f.a,{className:e.heroButtons},l),r.a.createElement(f.a,{className:e.icon},r.a.createElement(R.a,{container:!0,spacing:2,justify:"center"},m))),r.a.createElement(f.a,null,r.a.createElement(R.a,{container:!0,spacing:2,justify:"center"},u)))}}]),t}(r.a.Component),$=Object(k.withSnackbar)(Object(E.a)(q)(Z));var ee=Object(c.a)((function(e){return{icon:{marginRight:e.spacing(2)},heroContent:{backgroundColor:e.palette.background.paper,padding:e.spacing(8,0,6)},heroButtons:{marginTop:e.spacing(4)},cardGrid:{paddingTop:e.spacing(8),paddingBottom:e.spacing(8)},card:{height:"100%",display:"flex",flexDirection:"column"},cardMedia:{paddingTop:"56.25%"},cardContent:{flexGrow:1},footer:{backgroundColor:e.palette.background.paper,padding:e.spacing(6)}}}));o.a.render(r.a.createElement((function(){return ee(),r.a.createElement(k.SnackbarProvider,{maxSnack:3},r.a.createElement("main",null,r.a.createElement(l.a,null,r.a.createElement(m.a,{exact:!0,path:"/",component:B}),r.a.createElement(m.a,{path:"/game",component:$}))))}),null),document.getElementById("root"))},98:function(e,t,a){e.exports=a(118)}},[[98,1,2]]]);
//# sourceMappingURL=main.e792e62e.chunk.js.map